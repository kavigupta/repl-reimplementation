Sourced from https://github.com/ellisk42/ec with changes only for extraction and formatting.

Later changes may be added.
